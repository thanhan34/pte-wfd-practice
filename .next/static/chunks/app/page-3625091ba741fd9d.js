(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{988:(e,t,s)=>{"use strict";s.d(t,{HW:()=>p,JP:()=>x,Jx:()=>u,O3:()=>m,ab:()=>o,fp:()=>g,jy:()=>h,rh:()=>d});let a=!0,n=null,r=null;async function i(){try{let e=(n=await Promise.all([s.e(992),s.e(811),s.e(645),s.e(86)]).then(s.bind(s,9086))).authenticateUser(),t=new Promise((e,t)=>setTimeout(()=>t(Error("Firebase connection timeout")),1e4));await Promise.race([e,t]),a=!0,console.log("✅ Using Firebase for data storage")}catch(e){console.warn("⚠️ Firebase not available, using localStorage fallback:",e instanceof Error?e.message:"Unknown error"),a=!1,r=await s.e(799).then(s.bind(s,4799)),console.log("\uD83D\uDCE6 Using localStorage fallback for data storage")}}let l=!1;async function c(){l||(await i(),l=!0)}async function o(e){return await c(),(a?n:r).createRoom(e)}async function m(e,t){return await c(),(a?n:r).joinRoom(e,t)}async function h(e,t){return await c(),(a?n:r).setTargetPhrase(e,t)}async function u(e,t){return await c(),(a?n:r).submitAnswer(e,t)}async function d(e,t){return await c(),(a?n:r).updateTypingStatus(e,t)}async function x(e){return await c(),(a?n:r).leaveRoom(e)}async function g(e,t){return await c(),(a?n:r).subscribeToRoom(e,t)}async function p(){return await c(),(a?n:r).getCurrentUser()}},4762:(e,t,s)=>{Promise.resolve().then(s.bind(s,5177))},5177:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(5155),n=s(2115),r=s(5695),i=s(988);function l(e){let{onRemoved:t}=e,s=(0,r.useRouter)(),a=(0,r.useSearchParams)();return(0,n.useEffect)(()=>{"true"===a.get("removed")&&(t(),s.replace("/"))},[a,s,t]),null}function c(){let[e,t]=(0,n.useState)("select"),[s,c]=(0,n.useState)(""),[o,m]=(0,n.useState)(""),[h,u]=(0,n.useState)(!1),[d,x]=(0,n.useState)(""),[g,p]=(0,n.useState)(!1),b=(0,r.useRouter)(),j=async()=>{if(!s.trim())return void x("Vui l\xf2ng nhập nickname");u(!0),x("");try{let e=await (0,i.ab)(s.trim());b.push("/room/".concat(e))}catch(e){x("Kh\xf4ng thể tạo ph\xf2ng. Vui l\xf2ng thử lại."),console.error(e)}finally{u(!1)}},f=async()=>{if(!s.trim())return void x("Vui l\xf2ng nhập nickname");if(!o.trim())return void x("Vui l\xf2ng nhập m\xe3 ph\xf2ng");u(!0),x("");try{await (0,i.O3)(o.trim().toUpperCase(),s.trim()),b.push("/room/".concat(o.trim().toUpperCase()))}catch(e){x(e.message||"Kh\xf4ng thể tham gia ph\xf2ng. Vui l\xf2ng thử lại."),console.error(e)}finally{u(!1)}},y=()=>{c(""),m(""),x(""),t("select")};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-white flex items-center justify-center p-4",children:[(0,a.jsx)(n.Suspense,{fallback:null,children:(0,a.jsx)(l,{onRemoved:()=>{p(!0)}})}),(0,a.jsxs)("div",{className:"w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-primary-600 mb-2",children:"Ph\xf2ng luyện đ\xe1nh m\xe1y"}),(0,a.jsx)("h2",{className:"text-xl text-primary-500 mb-4",children:"Nh\xf3m thời gian thực"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Luyện kỹ năng g\xf5 ch\xednh x\xe1c cho PTE Write From Dictation"})]}),g&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-red-600 text-2xl",children:"\uD83D\uDEAB"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-red-800",children:"Bạn đ\xe3 bị loại khỏi ph\xf2ng"}),(0,a.jsx)("p",{className:"text-sm text-red-600",children:"Host đ\xe3 loại bạn ra khỏi ph\xf2ng luyện tập"})]})]}),(0,a.jsx)("button",{onClick:()=>p(!1),className:"text-red-500 hover:text-red-700",children:"✕"})]})}),(0,a.jsxs)("div",{className:"card",children:["select"===e&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-center mb-6",children:"Chọn vai tr\xf2 của bạn"}),(0,a.jsx)("button",{onClick:()=>t("host"),className:"w-full btn-primary py-4 text-lg",children:"\uD83C\uDFAF Tạo ph\xf2ng (Host)"}),(0,a.jsx)("button",{onClick:()=>t("join"),className:"w-full btn-secondary py-4 text-lg",children:"\uD83D\uDC65 Tham gia ph\xf2ng"}),(0,a.jsxs)("div",{className:"mt-6 p-4 bg-primary-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold text-primary-600 mb-2",children:"C\xe1ch sử dụng:"}),(0,a.jsxs)("ul",{className:"text-sm text-gray-700 space-y-1",children:[(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Host:"})," Tạo ph\xf2ng v\xe0 đặt c\xe2u mẫu"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Người tham gia:"})," Nghe v\xe0 g\xf5 lại c\xe2u"]}),(0,a.jsx)("li",{children:"• Hệ thống sẽ chấm điểm theo chuẩn PTE WFD"})]})]})]}),"host"===e&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Tạo ph\xf2ng mới"}),(0,a.jsx)("button",{onClick:y,className:"text-gray-500 hover:text-gray-700",children:"← Quay lại"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nickname của bạn"}),(0,a.jsx)("input",{type:"text",value:s,onChange:e=>c(e.target.value),placeholder:"Nhập nickname...",className:"input-field",maxLength:20})]}),d&&(0,a.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:d}),(0,a.jsx)("button",{onClick:j,disabled:h,className:"w-full btn-primary",children:h?"Đang tạo ph\xf2ng...":"Tạo ph\xf2ng"})]}),"join"===e&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Tham gia ph\xf2ng"}),(0,a.jsx)("button",{onClick:y,className:"text-gray-500 hover:text-gray-700",children:"← Quay lại"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"M\xe3 ph\xf2ng"}),(0,a.jsx)("input",{type:"text",value:o,onChange:e=>m(e.target.value.toUpperCase()),placeholder:"Nhập m\xe3 ph\xf2ng (6 k\xfd tự)...",className:"input-field",maxLength:6})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nickname của bạn"}),(0,a.jsx)("input",{type:"text",value:s,onChange:e=>c(e.target.value),placeholder:"Nhập nickname...",className:"input-field",maxLength:20})]}),d&&(0,a.jsx)("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-lg",children:d}),(0,a.jsx)("button",{onClick:f,disabled:h,className:"w-full btn-primary",children:h?"Đang tham gia...":"Tham gia ph\xf2ng"})]})]}),(0,a.jsxs)("div",{className:"text-center mt-8 text-sm text-gray-500",children:[(0,a.jsx)("p",{children:"Ứng dụng luyện tập PTE Write From Dictation"}),(0,a.jsx)("p",{className:"mt-1",children:"Phi\xean bản thời gian thực"})]})]})]})}},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},e=>{e.O(0,[441,964,358],()=>e(e.s=4762)),_N_E=e.O()}]);